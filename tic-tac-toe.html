<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Neox Tic Tac Toe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="default.css"/>
  <style>
    body {
      background: #0a0a0a;
      color: #f0f0f0;
      font-family: 'Poppins', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }
    h1 {
      margin-bottom: 10px;
      font-size: 2rem;
    }
    #controls {
      margin-bottom: 10px;
      text-align: center;
    }
    select {
      background: #1a1a1a;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      margin: 5px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
      gap: 12px;
      margin-top: 20px;
    }
    .cell {
      background: #1a1a1a;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .cell:hover {
      background: #292929;
      transform: scale(1.05);
    }
    .cell.bounce {
      animation: bounce 0.6s ease;
    }
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.5); }
    }
    #message {
      margin-top: 10px;
      font-size: 1.5rem;
      text-align: center;
    }
    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background-color: rgba(0, 0, 0, 0.9);
      padding: 30px;
      border-radius: 10px;
      color: white;
      font-size: 1.2rem;
      text-align: center;
      transition: transform 0.4s ease;
      z-index: 999;
    }
    .popup.active {
      transform: translate(-50%, -50%) scale(1);
    }
    .popup button {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 1rem;
      background: #333;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .popup button:hover {
      background: #444;
    }
  </style>
</head>
<body><h1>Neox Tic Tac Toe</h1><div id="controls">
  <label>Mode:</label>
  <select id="gameMode" onchange="restart()">
    <option value="single">Single Player</option>
    <option value="two">2 Player</option>
  </select><label>Difficulty:</label> <select id="difficulty" onchange="onDifficultyChange()"> <option value="easy">Easy</option> <option value="hard">Hard</option> <option value="impossible">Impossible</option> </select>

  <span id="whoGoesFirstContainer" style="display:none;">
    <label>You first?</label>
    <select id="whoGoesFirst" onchange="restart()">
      <option value="yes">Yes</option>
      <option value="no">No</option>
    </select>
  </span>
</div><div id="board"></div>
<div id="message"></div>
<div id="highScore"></div><div class="popup" id="popup">
  <p id="popupMessage"></p>
  <button onclick="restart()">Play Again</button>
</div><audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_e832e3fc03.mp3?filename=button-124476.mp3"></audio> <audio id="winSound" src="https://cdn.pixabay.com/download/audio/2022/03/23/audio_b81776d196.mp3?filename=success-fanfare-trumpets-6185.mp3"></audio> <audio id="drawSound" src="https://cdn.pixabay.com/download/audio/2022/02/17/audio_234b9a902e.mp3?filename=error-126627.mp3"></audio>

<script>
const boardElement = document.getElementById('board');
const messageElement = document.getElementById('message');
const popup = document.getElementById('popup');
const popupMessage = document.getElementById('popupMessage');
const clickSound = document.getElementById('clickSound');
const winSound = document.getElementById('winSound');
const drawSound = document.getElementById('drawSound');
const highScoreElement = document.getElementById('highScore');

let board = Array(9).fill('');
let player = 'X';
let bot = 'O';
let gameOver = false;
let isPlayerTurn = true;

let difficulty = 'easy';
let firstTurn = 'yes';
let gameMode = 'single';
let turnCount = 0;

function createBoard() {
  boardElement.innerHTML = '';
  board.forEach((_, index) => {
    const div = document.createElement('div');
    div.classList.add('cell');
    div.dataset.index = index;
    div.addEventListener('click', handleCellClick);
    boardElement.appendChild(div);
  });
}

function handleCellClick(e) {
  const idx = e.target.dataset.index;
  if (board[idx] || gameOver) return;
  clickSound.play();
  board[idx] = isPlayerTurn ? player : bot;
  updateBoard();
  if (checkWin(board[idx])) return endGame((board[idx] === player ? 'Player 1' : 'Player 2') + ' Wins!');
  if (board.every(cell => cell)) return endGame("It's a Draw!");

  if (gameMode === 'two') {
    isPlayerTurn = !isPlayerTurn;
    return;
  }

  isPlayerTurn = false;
  setTimeout(botMove, 400);
}

function botMove() {
  if (gameOver || gameMode !== 'single') return;
  let move;
  if (difficulty === 'easy') move = randomMove();
  else if (difficulty === 'hard') move = Math.random() < 0.5 ? bestMove() : randomMove();
  else move = bestMove();

  board[move] = bot;
  updateBoard();
  clickSound.play();
  if (checkWin(bot)) return endGame("Bot Wins!");
  if (board.every(cell => cell)) return endGame("Draw!");
  isPlayerTurn = true;
}

function randomMove() {
  const available = board.map((v, i) => v === '' ? i : null).filter(i => i !== null);
  return available[Math.floor(Math.random() * available.length)];
}

function updateBoard() {
  document.querySelectorAll('.cell').forEach((cell, index) => {
    cell.textContent = board[index];
  });
}

function checkWin(current) {
  const winPatterns = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for (const pattern of winPatterns) {
    if (pattern.every(i => board[i] === current)) {
      pattern.forEach(i => document.querySelectorAll('.cell')[i].classList.add('bounce'));
      winSound.play();
      return true;
    }
  }
  return false;
}

function endGame(msg) {
  gameOver = true;
  if (msg.includes("Win")) updateHighScore();
  if (msg.includes("Draw")) drawSound.play();
  messageElement.textContent = msg;
  popupMessage.textContent = msg;
  popup.classList.add('active');
}

function restart() {
  board = Array(9).fill('');
  gameOver = false;
  messageElement.textContent = '';
  popup.classList.remove('active');
  document.querySelectorAll('.cell').forEach(c => c.classList.remove('bounce'));
  difficulty = document.getElementById('difficulty').value;
  gameMode = document.getElementById('gameMode').value;
  const whoFirstBox = document.getElementById('whoGoesFirstContainer');
  whoFirstBox.style.display = (difficulty === 'impossible' && gameMode === 'single') ? 'inline' : 'none';
  isPlayerTurn = (document.getElementById('whoGoesFirst').value === 'yes');
  createBoard();
  if (gameMode === 'single' && !isPlayerTurn) setTimeout(botMove, 400);
}

function onDifficultyChange() {
  difficulty = document.getElementById('difficulty').value;
  restart();
}

function bestMove() {
  let best = -Infinity, move;
  for (let i = 0; i < 9; i++) {
    if (!board[i]) {
      board[i] = bot;
      let score = minimax(board, 0, false);
      board[i] = '';
      if (score > best) { best = score; move = i; }
    }
  }
  return move;
}

function minimax(b, depth, isMax) {
  if (checkStaticWin(bot, b)) return 10 - depth;
  if (checkStaticWin(player, b)) return depth - 10;
  if (b.every(c => c)) return 0;
  let best = isMax ? -Infinity : Infinity;
  for (let i = 0; i < 9; i++) {
    if (!b[i]) {
      b[i] = isMax ? bot : player;
      let score = minimax(b, depth + 1, !isMax);
      b[i] = '';
      best = isMax ? Math.max(score, best) : Math.min(score, best);
    }
  }
  return best;
}

function checkStaticWin(current, b) {
  return [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]].some(p => p.every(i => b[i] === current));
}

function updateHighScore() {
  const score = parseInt(localStorage.getItem('neoxScore') || '0') + 1;
  localStorage.setItem('neoxScore', score);
  highScoreElement.textContent = `ðŸ† Your Wins: ${score}`;
}

window.onload = () => {
  restart();
  updateHighScore();
};
</script></body>
</html>