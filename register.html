<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Register | Neox</title>
  <link rel="stylesheet" href="default.css"/>
</head>
<body>
  <div class="container">
    <h2>Register</h2>
    <input type="email" id="email" placeholder="Email" required />
    <input type="password" id="password" placeholder="Password" required />
    <input type="password" id="confirm-password" placeholder="Confirm Password" required />
    <button onclick="register()">Register</button>

    <div class="separator">OR</div>
    <button id="google-register">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="20" />
      <span id="google-register-text">Sign up with Google</span>
    </button>

    <a href="login.html">Already have an account? Login</a>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithPopup,
      GoogleAuthProvider,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC0w2CYNgPKciXQZ10h-vwnvW-8WmWiPdg",
      authDomain: "loginpage-55633.firebaseapp.com",
      projectId: "loginpage-55633",
      storageBucket: "loginpage-55633.appspot.com",
      messagingSenderId: "112787874903",
      appId: "1:112787874903:web:54070d414ef38b7e40af12"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    onAuthStateChanged(auth, user => {
      if (user) window.location.href = "/";
    });

    window.register = () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const confirmPassword = document.getElementById("confirm-password").value;

      if (password !== confirmPassword) {
        alert("Passwords do not match.");
        return;
      }

      createUserWithEmailAndPassword(auth, email, password)
        .then(() => window.location.href = "/")
        .catch(e => alert("Registration failed: " + e.message));
    };

    const googleBtn = document.getElementById("google-register");
    const googleText = document.getElementById("google-register-text");

    googleBtn.addEventListener("click", () => {
      googleBtn.disabled = true;
      googleText.textContent = "Signing in...";

      signInWithPopup(auth, provider)
        .then(() => window.location.href = "/")
        .catch(e => {
          alert("Google Sign-In failed: " + e.message);
          googleBtn.disabled = false;
          googleText.textContent = "Sign up with Google";
        });
    });
  </script>
</body>
</html>